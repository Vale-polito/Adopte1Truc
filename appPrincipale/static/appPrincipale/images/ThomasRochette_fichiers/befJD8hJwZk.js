if (self.CavalryLogger) { CavalryLogger.start_js(["QJeoh"]); }

__d("TimelineJumperCursorConfig",[],(function a(b,c,d,e,f,g){f.exports={BOUNDARY_PREFIX:"boundary",CURSOR_PREFIX:"jumper",CURSOR_DELIMITER:"_"};}),null);
__d('ScrollPositionFixer',['Event','nullthrows'],(function a(b,c,d,e,f,g){'use strict';var h={_bodyElement:c('nullthrows')(document.body),_domModifiedListener:null,_element:null,_htmlElement:c('nullthrows')(document.documentElement),_originalLeft:0,_originalTop:0,fixToElement:function i(j){var k=arguments.length<=1||arguments[1]===undefined?h._htmlElement:arguments[1];if(this._element)throw new Error('Scroll position fixer is already holding on to an element:'+this._element);this._element=j;this._originalTop=this._calculateElementTop();this._originalLeft=this._calculateElementLeft();this._onSubtreeModified();this._domModifiedListener=c('Event').listen(k,'DOMSubtreeModified',this._onSubtreeModified.bind(this));},release:function i(){if(!this._element)throw new Error('Scroll position fixer is not holding on to an element!');this._onSubtreeModified();this._domModifiedListener.remove();this._domModifiedListener=null;this._element=null;},_onSubtreeModified:function i(){window.scrollBy(this._calculateElementLeft()-this._originalLeft,this._calculateElementTop()-this._originalTop);},_calculateElementTop:function i(){var j=this._htmlElement.scrollTop||this._bodyElement.scrollTop;return this._element.offsetTop-j;},_calculateElementLeft:function i(){var j=this._htmlElement.scrollLeft||this._bodyElement.scrollLeft;return this._element.offsetLeft-j;}};h.fixToElement=h.fixToElement.bind(h);h.release=h.release.bind(h);f.exports=h;}),null);
__d('TimelineJumperStore',['fbt','DataStore','FBJSON','FluxReduceStore','immutable','SimpleNUXMessage','SimpleNUXMessageTypes','TimelineJumperDispatcher','TimelineSectionToken','TimelineMonitorElements','TimelineSectionTokenConstants','DateConsts'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('immutable').List,l=c('TimelineSectionTokenConstants').RECENT_TOKEN,m=c('DateConsts').MS_PER_SEC,n=2;i=babelHelpers.inherits(o,c('FluxReduceStore'));j=i&&i.prototype;o.prototype.getInitialState=function(){return {error:null,isPrevPageReady:false,nextCursor:null,nextPageLoadingToken:null,prevCursor:null,prevPageLoadingToken:null,prevPage:k([]),profileID:null,retryCount:0,scrollToElement:null,showNux:false,storyFragments:k([]),viewerID:null};};o.prototype.reduce=function(p,q){var r=q.payload;switch(q.actionType){case 'initialize':if(r){var s=!c('SimpleNUXMessage').hasUserSeenMessage(c('SimpleNUXMessageTypes').PROFILE_JUMPER_NUX);p=babelHelpers['extends']({},this.getInitialState(),{nextCursor:r.nextCursor,prevCursor:r.prevCursor,profileID:r.profileID,storyFragments:k(r.storyFragments),viewerID:r.viewerID,showNux:s});}break;case 'header_nav_scroll_to':if(r){var t=this.getStory(r.key);if(t){p=babelHelpers['extends']({},p,{scrollToElement:t});}else{c('TimelineMonitorElements').clear();p=this.$TimelineJumperPageStore1(r.key,p);}}break;case 'fetch_next_page':p=babelHelpers['extends']({},p,{nextPageLoadingToken:this.getNextCursor()});break;case 'prefetch_prev_page':p=babelHelpers['extends']({},p,{prevPageLoadingToken:this.getPrevCursor(),showNux:false});break;case 'next_page_fetch_success':if(r&&r.cursorToken!==this.getNextPageLoadingToken())break;if(r&&Array.isArray(r.stories)&&r.stories.length!==0){p=this.$TimelineJumperPageStore2('next_fetch',p,r);}else p=this.$TimelineJumperPageStore3('next_fetch',p);break;case 'prev_page_fetch_success':if(r&&r.cursorToken!==this.getPrevPageLoadingToken())break;if(r&&Array.isArray(r.stories)&&r.stories.length!==0){p=this.$TimelineJumperPageStore2('prev_fetch',p,r);}else p=this.$TimelineJumperPageStore3('prev_fetch',p);break;case 'page_fetch_timeout':case 'page_fetch_fail':if(!r)break;p=this.$TimelineJumperPageStore4(p,r.direction,r.errorMessage,r.errorCode);break;case 'show_prev_page':p=this.$TimelineJumperPageStore5(p);break;case 'close_nux':p=babelHelpers['extends']({},p,{showNux:false});break;case 'clear_scroll_to_element':p=babelHelpers['extends']({},p,{scrollToElement:null});break;case 'on_leave':default:p=this.getInitialState();break;}return p;};o.prototype.getError=function(){return this.getState().error;};o.prototype.getNextPageLoadingToken=function(){return this.getState().nextPageLoadingToken;};o.prototype.getPrevPageLoadingToken=function(){return this.getState().prevPageLoadingToken;};o.prototype.getIsPrevPageReady=function(){return this.getState().isPrevPageReady;};o.prototype.getNextCursor=function(){return this.getState().nextCursor;};o.prototype.getPrevCursor=function(){return this.getState().prevCursor;};o.prototype.getPrevPage=function(){return this.getState().prevPage;};o.prototype.getProfileID=function(){return this.getState().profileID;};o.prototype.getScrollToElement=function(){return this.getState().scrollToElement;};o.prototype.getShouldShowNux=function(){return this.getState().showNux;};o.prototype.getStoryFragments=function(){return this.getState().storyFragments;};o.prototype.getViewerID=function(){return this.getState().viewerID;};o.prototype.$TimelineJumperPageStore4=function(p,q,r,s){var t=s&&s===500;if(!t&&p.retryCount<n)return this.$TimelineJumperPageStore6(p,q);var u=void 0;if(!r||t){u=h._("D\u00e9sol\u00e9, mais la page n\u2019a pu \u00eatre correctement charg\u00e9e. Veuillez r\u00e9essayer.");}else u=r;if(q==='next_fetch'){p=babelHelpers['extends']({},p,{error:u.toString()});}else p=babelHelpers['extends']({},p,{error:u.toString(),isPrevPageReady:false});return p;};o.prototype.$TimelineJumperPageStore6=function(p,q){if(q==='next_fetch'){p=babelHelpers['extends']({},p,{nextPageLoadingToken:null,retryCount:p.retryCount+1});}else p=babelHelpers['extends']({},p,{prevPageLoadingToken:null,isPrevPageReady:false,retryCount:p.retryCount+1});return p;};o.prototype.$TimelineJumperPageStore2=function(p,q,r){if(p==='prev_fetch'){q=babelHelpers['extends']({},q,{prevPageLoadingToken:null,isPrevPageReady:true,prevCursor:r.cursor,prevPage:k(r.stories)});}else{var s=this.getStoryFragments().concat(r.stories);q=babelHelpers['extends']({},q,{nextPageLoadingToken:null,nextCursor:r.cursor,storyFragments:s});}return q;};o.prototype.$TimelineJumperPageStore3=function(p,q){if(p==='prev_fetch'){q=babelHelpers['extends']({},q,{prevPageLoadingToken:null,isPrevPageReady:false,prevCursor:null,prevPage:k([])});}else q=babelHelpers['extends']({},q,{nextPageLoadingToken:null,nextCursor:null});return q;};o.prototype.$TimelineJumperPageStore5=function(p){var q=this.getPrevPage().concat(this.getStoryFragments());return babelHelpers['extends']({},p,{isPrevPageReady:false,prevPage:k([]),storyFragments:q});};o.prototype.$TimelineJumperPageStore1=function(p,q){var r=null,s=null;if(p===l){s=c('TimelineSectionToken').getCursorFromRecentToken();}else{s=c('TimelineSectionToken').getCursorFrom(p);r=s;}return babelHelpers['extends']({},this.getInitialState(),{profileID:q.profileID,nextCursor:s,prevCursor:r,showNux:q.showNux,viewerID:q.viewerID});};o.prototype.$TimelineJumperPageStore7=function(p){var q=c('FBJSON').parse(c('DataStore').get(p,'store'));return parseInt(q.timestamp,10);};o.prototype.getStory=function(p){var q=this.getStoryFragments();if(q.size===0)return null;var r=void 0;if(p===l){r=Date.now()/m;}else{var s=c('TimelineSectionToken').getYearFrom(p),t=c('TimelineSectionToken').getMonthFrom(p);r=new Date(s,t,1).valueOf()/m-1;}var u=this.$TimelineJumperPageStore7(q.first()),v=this.$TimelineJumperPageStore7(q.last());if(r>u){return null;}else if(r<v)return null;var w=void 0;for(var x=0;x<q.size;x++){w=q.get(x);if(this.$TimelineJumperPageStore7(w)>r)continue;break;}return w;};function o(){i.apply(this,arguments);}f.exports=new o(c('TimelineJumperDispatcher'));}),null);
__d("XTimelineJumperAsyncController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/timeline\/jumper\/async\/",{cursor:{type:"String"},is_front_fetch:{type:"Bool",defaultValue:false},profile_id:{type:"FBID",required:true},viewer_id:{type:"FBID"}});}),null);
__d('TimelineJumperContainer.react',['ix','cx','fbt','Arbiter','AsyncRequest','DOMContainer.react','DOMScroll','FBMorePager.react','FluxContainer','Image.react','immutable','ProfileTimelineUILogger','React','Run','ScrollPositionFixer','SimpleNUXMessage','SimpleNUXMessageTypes','TimelineJumperAction','TimelineJumperDispatcher','TimelineJumperStore','TimelineMonitorElements','TimelineStickyHeaderWithJumperNav','Vector','XUIAmbientNUX.react','XUIButton.react','XUICard.react','XUINotice.react','XUISpinner.react','XTimelineJumperAsyncController','fbglyph','tidyEvent'],(function a(b,c,d,e,f,g,h,i,j){'use strict';var k,l,m=c('immutable').List,n=100;k=babelHelpers.inherits(o,c('React').Component);l=k&&k.prototype;o.getStores=function(){return [c('TimelineJumperStore')];};o.calculateState=function(p){var q=c('TimelineJumperStore').getError(),r=c('TimelineJumperStore').getIsPrevPageReady(),s=c('TimelineJumperStore').getNextCursor(),t=c('TimelineJumperStore').getNextPageLoadingToken(),u=c('TimelineJumperStore').getPrevPageLoadingToken(),v=c('TimelineJumperStore').getPrevCursor(),w=c('TimelineJumperStore').getProfileID(),x=c('TimelineJumperStore').getScrollToElement(),y=c('TimelineJumperStore').getShouldShowNux(),z=c('TimelineJumperStore').getStoryFragments(),aa=c('TimelineJumperStore').getViewerID();return {error:q,isPrevPageReady:r,nextCursor:s,nextPageLoadingToken:t,prevCursor:v,prevPageLoadingToken:u,profileID:w,scrollToElement:x,showNux:y,storyFragments:z,viewerID:aa};};function o(p){l.constructor.call(this,p);c('TimelineJumperDispatcher').explicitlyRegisterStores([c('TimelineJumperStore')]);c('TimelineJumperAction').initialize({profileID:p.profileID,nextCursor:p.initialAfterCursor,prevCursor:p.initialBeforeCursor,storyFragments:p.initialStoryFragments,viewerID:p.viewerID});c('Run').onLeave(function(){return this.reset();}.bind(this));}o.prototype.reset=function(){c('TimelineJumperAction').onLeave();};o.prototype.$TimelineJumperContainer5=function(){c('tidyEvent')(c('Arbiter').subscribe(c('TimelineMonitorElements').ELEMENT_CHANGED,function(p,q){c('TimelineStickyHeaderWithJumperNav').updateSelectedWithData(q);}));};o.prototype.$TimelineJumperContainer6=function(){if(this.state.nextPageLoadingToken===null&&this.state.nextCursor){c('TimelineJumperAction').fetchNextPage();this.$TimelineJumperContainer7('next_fetch');c('ProfileTimelineUILogger').logJumperMoreStoriesSpinnerView(this.state.nextCursor||'');}};o.prototype.$TimelineJumperContainer8=function(){if(!this.state.isPrevPageReady&&this.state.prevPageLoadingToken===null&&this.state.prevCursor){if(this.state.showNux)this.$TimelineJumperContainer9();c('TimelineJumperAction').prefetchPrevPage();this.$TimelineJumperContainer7('prev_fetch');c('ProfileTimelineUILogger').logJumperRecentStoriesButtonClick(this.state.prevCursor||'');}};o.prototype.$TimelineJumperContainer10=function(){if(!this.state.isPrevPageReady){this.$TimelineJumperContainer8();}else c('TimelineJumperAction').showPrevPage();};o.prototype.$TimelineJumperContainer7=function(p){var q=p==='prev_fetch',r=q?this.state.prevCursor:this.state.nextCursor,s=c('XTimelineJumperAsyncController').getURIBuilder().setString('cursor',r).setFBID('profile_id',this.state.profileID).setFBID('viewer_id',this.state.viewerID).setBool('is_front_fetch',q).getURI();c('TimelineJumperAction').fetchURI(s,p);};o.prototype.componentDidMount=function(){this.$TimelineJumperContainer5();this.$TimelineJumperContainer11(null,this.state);};o.prototype.componentWillUpdate=function(p,q){if(q.isPrevPageReady)c('ScrollPositionFixer').fixToElement(this.$TimelineJumperContainer3,this.$TimelineJumperContainer2);};o.prototype.componentDidUpdate=function(p,q){if(this.state.isPrevPageReady)this.$TimelineJumperContainer10();if(this.state.nextCursor&&this.state.nextCursor.includes('jumper')&&this.$TimelineJumperContainer1){var r=c('Vector').getElementPosition(this.$TimelineJumperContainer1);window.scrollTo(0,r.y-n);}if(q.isPrevPageReady)setTimeout(c('ScrollPositionFixer').release,0);if(this.state.scrollToElement){c('DOMScroll').scrollTo(this.state.scrollToElement);c('TimelineJumperAction').clearScrollTo();}this.$TimelineJumperContainer11(q,this.state);};o.prototype.$TimelineJumperContainer11=function(p,q){var r=q.storyFragments.size,s=p?p.storyFragments.size:0,t=r-s;if(t===0)return;if(p&&p.isPrevPageReady){var u=q.storyFragments.take(t).reverse();u.map(function(w){return c('TimelineMonitorElements').monitorTopElement(w);});}else{var v=q.storyFragments.takeLast(t);v.map(function(w){return c('TimelineMonitorElements').monitorBottomElement(w);});}};o.prototype.$TimelineJumperContainer12=function(){return c('React').createElement('div',{ref:function(p){return this.$TimelineJumperContainer1=p;}.bind(this),className:"_3fkc"},c('React').createElement(c('XUISpinner.react'),{background:'light',size:'large'}));};o.prototype.$TimelineJumperContainer13=function(){if(this.state.error!==null&&this.state.prevPageLoadingToken!==null)return c('React').createElement(c('XUINotice.react'),{use:'warn'},this.state.error);var p=c('React').createElement(c('XUIButton.react'),{className:"_mch _2e42",image:c('React').createElement(c('Image.react'),{src:h("128521")}),label:j._("Voir des publications plus r\u00e9centes"),onClick:function(){return this.$TimelineJumperContainer8();}.bind(this),size:'xlarge',ref:function(s){return this.$TimelineJumperContainer4=s;}.bind(this)}),q=this.state.prevPageLoadingToken!==null?c('React').createElement(c('XUICard.react'),{className:"_2e42 _nsv _mch",background:'transparent'},this.$TimelineJumperContainer12()):c('React').createElement('div',null,p,this.$TimelineJumperContainer14()),r=null;if(this.state.storyFragments.size!==0)r=this.state.prevCursor!==null||this.state.isPrevPageReady||this.state.prevPageLoadingToken!==null?q:null;return r;};o.prototype.$TimelineJumperContainer15=function(){if(this.state.error!==null&&this.state.nextPageLoadingToken!==null)return c('React').createElement(c('XUINotice.react'),{use:'warn'},this.state.error);var p=c('React').createElement(c('FBMorePager.react'),{onMore:function(){return this.$TimelineJumperContainer6();}.bind(this),buffer:300},this.$TimelineJumperContainer12());return this.state.nextCursor===null?null:p;};o.prototype.$TimelineJumperContainer14=function(){if(!this.state.showNux)return null;var p=j._("Vous pouvez charger des publications plus r\u00e9centes \u00e0 partir de ce point.");return c('React').createElement(c('XUIAmbientNUX.react'),{contextRef:function(){return this.$TimelineJumperContainer4;}.bind(this),onCloseButtonClick:function(){return this.$TimelineJumperContainer9();}.bind(this),position:'below',shown:this.state.showNux,width:'auto',alignment:'center',key:'jumper_nux'},p);};o.prototype.$TimelineJumperContainer9=function(){c('SimpleNUXMessage').markMessageSeenByUser(c('SimpleNUXMessageTypes').PROFILE_JUMPER_NUX);};o.prototype.render=function(){return c('React').createElement('div',{ref:function(p){return this.$TimelineJumperContainer2=p;}.bind(this)},this.$TimelineJumperContainer13(),this.state.storyFragments.map(function(p){return c('React').createElement(c('DOMContainer.react'),{key:p.id},p);}),c('React').createElement('div',{ref:function(p){return this.$TimelineJumperContainer3=p;}.bind(this)}),this.$TimelineJumperContainer15());};f.exports=c('FluxContainer').create(o);}),null);