if (self.CavalryLogger) { CavalryLogger.start_js(["d5W03"]); }

__d('TimelineJumperDispatcher',['ExplicitRegistrationReactDispatcher'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('ExplicitRegistrationReactDispatcher'));i=h&&h.prototype;function j(k){i.constructor.call(this,k);this.dispatch=this.dispatch.bind(this);}f.exports=new j({strict:true});}),null);
__d('TimelineJumperAction',['AsyncRequest','AsyncResponse','TimelineJumperDispatcher','URI'],(function a(b,c,d,e,f,g){'use strict';var h=60000,i={initialize:function j(k){c('TimelineJumperDispatcher').dispatch({actionType:'initialize',payload:k});},headerNavScrollTo:function j(k){c('TimelineJumperDispatcher').dispatch({actionType:'header_nav_scroll_to',payload:{key:k}});},handlePageFetchSuccess:function j(k){if(k===null)return;var l=k.isFrontFetch?'prev_page_fetch_success':'next_page_fetch_success';c('TimelineJumperDispatcher').dispatch({actionType:l,payload:{cursor:k.resultCursor,cursorToken:k.fetchToken,stories:k.stories}});},fetchURI:function j(k,l){new (c('AsyncRequest'))().setURI(k).setErrorHandler(function(m){i.pageFetchFail(l,m);}).setTimeoutHandler(h,function(m){i.pageFetchTimeout(l,m);}).send();},fetchNextPage:function j(){c('TimelineJumperDispatcher').dispatch({actionType:'fetch_next_page'});},prefetchPrevPage:function j(){c('TimelineJumperDispatcher').dispatch({actionType:'prefetch_prev_page'});},pageFetchTimeout:function j(k,l){c('TimelineJumperDispatcher').dispatch({actionType:'page_fetch_timeout',payload:{direction:k,errorCode:null,errorMessage:null}});},pageFetchFail:function j(k,l){c('TimelineJumperDispatcher').dispatch({actionType:'page_fetch_fail',payload:{direction:k,errorCode:l.getError(),errorMessage:l.getErrorDescription()}});},showPrevPage:function j(){c('TimelineJumperDispatcher').dispatch({actionType:'show_prev_page'});},clearScrollTo:function j(){c('TimelineJumperDispatcher').dispatch({actionType:'clear_scroll_to_element'});},onLeave:function j(){c('TimelineJumperDispatcher').dispatch({actionType:'on_leave'});}};f.exports=i;}),null);
__d('TimelineMonitorElements',['Arbiter','DataStore','Event','FBJSON','Run','Vector','ViewportBounds','queryThenMutateDOM','throttle'],(function a(b,c,d,e,f,g){'use strict';var h=null,i=null,j=[],k=0,l=null,m=false;function n(){j=[];h=null;i=null;k=0;l&&l.remove();l=null;m=false;}function o(){if(!l)l=c('Event').listen(window,'scroll',c('throttle')(p,50));if(!m){c('Run').onLeave(n);m=true;}p();}function p(){c('queryThenMutateDOM')(s,q,'TimelineMonitorElements/scroll');}function q(){if(i){c('Arbiter').inform(u.ELEMENT_CHANGED,i);h=i;i=null;}}function r(v){var w=c('FBJSON').parse(c('DataStore').get(v,'store'));return parseInt(w.timestamp,10);}function s(){var v=c('ViewportBounds').getTop()+c('Vector').getScrollPosition().y,w=t(v);if(w){if(h&&h.id===w.id){k=v;return;}var x=r(w);i={timestamp:x,fromAbove:k<v};}k=v;}function t(v){for(var w=0;w<j.length;w++){var x=j[w],y=c('Vector').getElementPosition(x).y+c('Vector').getElementDimensions(x).y;if(v<=y)return x;}return null;}var u={ELEMENT_CHANGED:'TimelineMonitorElements/elementChanged',monitorTopElement:function v(w){j.unshift(w);o();},monitorBottomElement:function v(w){j.push(w);o();},clear:function v(){j=[];k=0;h=null;i=null;}};f.exports=u;}),null);
__d('TimelineSectionTokenConstants',[],(function a(b,c,d,e,f,g){'use strict';var h={KEY_MONTH_POSITION:2,KEY_YEAR_POSITION:1,LAST_MONTH_OF_YEAR:12,MIN_TOKENS_PER_KEY:2,KEY_LENGTH_WITH_MONTH:3,KEY_DELIMITER:'_',RECENT_TOKEN:'recent',MONTH_TOKEN_PREFIX:'month',YEAR_TOKEN_PREFIX:'year'};f.exports=h;}),null);
__d('TimelineSectionToken',['TimelineSectionTokenConstants','DateConsts','TimelineJumperCursorConfig'],(function a(b,c,d,e,f,g){'use strict';var h=c('TimelineSectionTokenConstants').KEY_DELIMITER,i=c('TimelineSectionTokenConstants').KEY_LENGTH_WITH_MONTH,j=c('TimelineSectionTokenConstants').KEY_MONTH_POSITION,k=c('TimelineSectionTokenConstants').KEY_YEAR_POSITION,l=c('TimelineSectionTokenConstants').LAST_MONTH_OF_YEAR,m=c('TimelineSectionTokenConstants').MIN_TOKENS_PER_KEY,n=c('TimelineSectionTokenConstants').MONTH_TOKEN_PREFIX,o=c('DateConsts').MS_PER_SEC,p=c('TimelineJumperCursorConfig').CURSOR_PREFIX,q=c('TimelineJumperCursorConfig').CURSOR_DELIMITER,r={createMonthTokenWithYearAndMonth:function s(t,u){return n.concat(h,t.toString(),h,u.toString());},createMonthTokenWithKey:function s(t,u){var v=this.getYearFrom(t);return this.createMonthTokenWithYearAndMonth(v,u);},checkForMonthIn:function s(t){var u=this._getPartsFrom(t);return u.length===i;},getMonthFrom:function s(t){var u=this._getPartsFrom(t);return u.length===i?parseInt(u[j],10):l;},getYearFrom:function s(t){var u=this._getPartsFrom(t);return parseInt(u[k],10);},getCursorFromRecentToken:function s(){var t=Date.now()/o;return p.concat(q,t.toString());},getCursorFrom:function s(t){var u=this.getYearFrom(t),v=this.getMonthFrom(t),w=(new Date(u,v,1).valueOf()/o-1).toString();return p.concat(q,w);},_getPartsFrom:function s(t){var u=t.split(h);if(u.length<m)throw new Error('Invalid token length, expected at least: '+m+', received: '+u.length);return u;}};f.exports=r;}),null);
__d('TimelineStickyHeaderWithJumperNav',['ButtonGroup','CSS','DataStore','DOM','Event','Parent','ProfileTimelineUILogger','Run','SelectorDeprecated','SubscriptionsHandler','TimelineJumperAction','TimelineSectionToken','URI','TimelineSectionTokenConstants','DateConsts'],(function a(b,c,d,e,f,g){'use strict';var h=c('TimelineSectionTokenConstants').KEY_DELIMITER,i=c('TimelineSectionTokenConstants').KEY_LENGTH_WITH_MONTH,j=c('TimelineSectionTokenConstants').RECENT_TOKEN,k=c('TimelineSectionTokenConstants').YEAR_TOKEN_PREFIX,l=c('DateConsts').MS_PER_SEC,m={_initialized:false,_menuGroup:null,_pageMenu:null,_sectionMenu:null,_subsectionMenus:{},_subsectionMenuTemplate:null,_subscriptions:null,init:function n(o){if(this._initialized)return;this._initialized=true;this._pageMenu=c('DOM').find(o,'div.pageMenu');this._menuGroup=c('ButtonGroup').getInstance(this._pageMenu);this._sectionMenu=c('DOM').find(o,'div.sectionMenu');this._subsectionMenuTemplate=c('DOM').find(o,'div.subsectionMenu');this._subscriptions=new (c('SubscriptionsHandler'))();this._initSectionMenu();this._subscriptions.addSubscriptions(c('Event').listen(this._pageMenu,'click',function(event){return this._handleTabClick(event);}.bind(this)));c('Run').onLeave(function(){return this.reset();}.bind(this));},reset:function n(){this._initialized=false;this._menuGroup=null;this._pageMenu=null;this._sectionMenu=null;this._subsectionMenus={};this._subsectionMenuTemplate=null;this._subscriptions.release();},updateSelectedWithData:function n(o){if(!o.timestamp||!this._sectionMenu)return;var p=new Date(parseInt(o.timestamp,10)*l),q=(p.getMonth()+1).toString(),r=k.concat(h,p.getFullYear().toString());if(c('SelectorDeprecated').getOption(this._sectionMenu,r)){c('SelectorDeprecated').setSelected(this._sectionMenu,r,true);this._showOrHideSubsectionMenuForKey(r);var s=this._subsectionMenus[r];if(s)c('SelectorDeprecated').setSelected(s,q,true);}else{c('SelectorDeprecated').setSelected(this._sectionMenu,j,true);this._showOrHideSubsectionMenuForKey(j);}},_initSectionMenu:function n(){var o=c('SelectorDeprecated').getSelectorMenu(this._sectionMenu);this._subscriptions.addSubscriptions(c('Event').listen(o,'click',function(event){return this._handleClickedMenu(event);}.bind(this)));},_handleClickedMenu:function n(event){var o=c('Parent').byTag(event.target,'a'),p=o&&c('DataStore').get(o,'key');if(p){c('TimelineJumperAction').headerNavScrollTo(p);c('ProfileTimelineUILogger').logStickyHeaderScrubberWithJumperClick(p);event.preventDefault();this._showOrHideSubsectionMenuForKey(p);}},_showOrHideSubsectionMenuForKey:function n(o){if(o===j){this._hideSubsectionMenus();}else this._showSubsectionMenuForKey(o);},_hideSubsectionMenus:function n(){if(this._menuGroup)this._menuGroup.hideItem(this._subsectionMenuTemplate);},_showSubsectionMenuForKey:function n(o){if(o.split(h).length===i)return;var p=this._createSubsectionMenuForKey(o);c('DOM').insertAfter(this._subsectionMenuTemplate,p);c('CSS').hide(this._subsectionMenuTemplate);for(var q in this._subsectionMenus){var r=this._subsectionMenus[q];c('CSS').conditionShow(r,r===p);}if(this._menuGroup)this._menuGroup.showItem(this._subsectionMenuTemplate);},_createSubsectionMenuForKey:function n(o){var p=this._subsectionMenus[o];if(!p){p=this._subsectionMenus[o]=this._subsectionMenuTemplate.cloneNode(true);var q=c('DOM').scry(p,'li.activityLog a')[0];if(q)q.href=new (c('URI'))(q.href).addQueryData({key:o});var r=c('DOM').scry(p,'li.monthSelector a');for(var s=0;s<r.length;s++){var t=r[s],u=t.getAttribute('data-key');t.setAttribute('data-key',c('TimelineSectionToken').createMonthTokenWithKey(o,u));}this._subscriptions.addSubscriptions(c('Event').listen(p,'click',function(event){return this._handleClickedMenu(event);}.bind(this)));}return p;},_handleTabClick:function n(event){var o=c('Parent').byClass(event.target,'itemAnchor');if(o){var p=c('DataStore').get(o,'tab-key');if(p)c('ProfileTimelineUILogger').logStickyHeaderNavItemWithJumperClick(p);}}};f.exports=m;}),null);